@using Sakura.AspNetCore.Localization

@model IPagedList<App>
@inject IDynamicViewLocalizer ViewLocalizer
@{
	ViewBag.Title = "应用一览";
	ViewBag.ShowOwner = true;
}

<div class="alert alert-info">该列表中列出了系统中所有应用的信息。</div>

@if (Model.Any())
{
	@await Html.PartialAsync("_AppListPartial")
	<pager />
}
else
{
	<p class="text-muted text-center">目前系统中还没有任何应用</p>
}

<form asp-controller="App" asp-action="Delete" method="post" asp-antiforgery="true" data-ajax="true" data-ajax-failure="handleAjaxFailure(xhr, '#delete-app-error')">
	<input type="hidden" id="delete-app-id" name="id" />
	<div class="modal fade" id="delete-app-modal">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">删除应用</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="关闭">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<p>
						你确定要删除应用 <strong id="delete-app-name"></strong> 吗？这个操作无法撤销。删除应用后，该应用将无法使用 CC98 账户登录。如果你确定要执行删除操作，请单击对话框的<q>确认删除</q>按钮。
					</p>
				</div>
				<div class="modal-footer">
					<p class="text-danger" id="delete-app-error"></p>
					<button type="submit" class="btn btn-danger">确认删除</button>
					<button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
				</div>
			</div>
		</div>
	</div>
</form>

@section Scripts{

	<script>

		function deleteApp(ele) {

			var row = $(ele).closest('tr');

			var id = $(row).data('id');
			var name = $(row).data('name');

			$('#delete-app-id').val(id);
			$('#delete-app-name').text(name);

			$('#delete-app-modal').modal();
		}

	</script>

}